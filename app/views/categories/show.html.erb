<div class="container" data-controller="categories">
  <h3 class="my-3"><%= @category.name %></h3>
  <% if @products.length > 0 %>
    <div>
      <a class="btn btn-primary" data-action="click->categories#showFilters">Mostrar filtros</a>
      <%= simple_form_for :filter, url: category_path(@category), method: :get do |f| %>
          <div class="filters filters-closed" data-target="categories.filters">
            <%= link_to "Filtros Claros", category_path(@category), class: "filter-btn" %>
            <div class="filter-btn" data-action="click->categories#toggleSlider">Precio / Oferta</div>
            <%= f.input :time, collection: [['Tiempo Restante', ''],['1 day', 1], ['3 days', 3], ['7 days', 7]], label: false, required: false, selected: params.dig(:filter, :time), input_html: { class: "filter-btn", data: { action: "change->categories#triggerFilter" } } %>
          </div>
          <div class="slider-container" data-target="categories.slider">
            <div class="price-slider" data-min="<%= @min %>" data-max="<%= @max %>" data-start="<%= @start || @min %>" data-end="<%= @end || @max %>" data-action="click->categories#triggerFilter"></div>
            <div class="slider-display d-flex justify-content-center"></div>
            <%= f.input :price, as: :hidden %>
          </div>
          <%= f.submit 'Filter', class: "d-none", data: { target: "categories.filterBtn" } %>
      <% end %>
    </div>
    <div class="product-grid my-4">
      <% @products.each do |product| %>
        <%= render "shared/product_card", product: product, admin: false %>
      <% end %>
    </div>
  <% else %>
    <h4 class="text-center mt-5">No hay subastas activas en este momento</h4>
    <h4 class="text-center">Por favor, inténtelo de nuevo más tarde</h4>
    <% if params[:filter] %>
      <div class="button-holder mt-5">
        <%= link_to "Filtros Claros", category_path(@category), class: "btn btn-primary" %>
      </div>
    <% end %>
  <% end %>
</div>
